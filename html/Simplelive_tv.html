<link rel="stylesheet" href="https://cdn.staticfile.net/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
<script src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.6.0/js/bootstrap.min.js"></script>
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Simplelive tv版 - 艾曲君の文件仓库</title>
<script>
  // 百度统计
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?977640fcb291f261ac84657fcb68a83a";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>        
</head>
<body>
<p>下载信息：</p>
<script>
// 使用 XMLHttpRequest 获取 GitHub API 数据
function fetchLatestReleaseInfo() {
  const xhr = new XMLHttpRequest();
  const url = 'https://api.github.com/repos/xiaoyaocz/dart_simple_live/releases';

  xhr.open('GET', url, true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4 && xhr.status === 200) {
      const releases = JSON.parse(xhr.responseText);
      const latestTvRelease = releases.find(release => release.tag_name.includes('tv_v'));
      
      if (latestTvRelease) {
        displayReleaseInfo(latestTvRelease);
      }
    }
  };
  xhr.send();
}

// 显示版本信息到 HTML 页面
function displayReleaseInfo(release) {
  const versionElement = document.getElementById('version');
  const dateElement = document.getElementById('update-date');
  const contentElement = document.getElementById('update-content');
  const downloadElement = document.getElementById('download-links');

  // 设置版本号
  versionElement.textContent = `版本号: ${release.tag_name}`;
  // 设置更新日期
  dateElement.textContent = `更新日期: ${new Date(release.published_at).toLocaleDateString()}`;
  // 设置更新内容
  contentElement.innerHTML = `更新内容: ${release.body}`;
  
  // 获取并显示所有APK下载链接
const apkLinks = release.assets
  .filter(asset => asset.name.endsWith('.apk'))
  .map(asset => `<a href="${asset.browser_download_url}">${asset.browser_download_url}</a>`)
  .join('<br>');

downloadElement.innerHTML = `下载地址:<br>${apkLinks}`;
}

// 当页面加载完成时，调用 fetchLatestReleaseInfo 函数
document.addEventListener('DOMContentLoaded', fetchLatestReleaseInfo);
</script>
<div>
  <p id="version"></p>
  <p id="update-date"></p>
  <div id="update-content"></div>
  <div id="download-links"></div>
</div>
</body>
</html>